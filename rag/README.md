# CodeWise RAGæœåŠ¡

åŸºäºFastAPIçš„RAGï¼ˆRetrieval-Augmented Generationï¼‰æœåŠ¡ï¼Œé›†æˆBAAI/bge-m3åµŒå…¥æ¨¡å‹å’ŒChromaDBå‘é‡æ•°æ®åº“ï¼Œä¸ºCodeWiseä»£ç çŸ¥è¯†å›¾è°±æä¾›æ™ºèƒ½æ£€ç´¢èƒ½åŠ›ã€‚

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# æ¿€æ´»codewiseè™šæ‹Ÿç¯å¢ƒ
conda activate codewise

# å®‰è£…ä¾èµ–
cd rag
pip install -r requirements.txt
```

### 2. å¯åŠ¨æœåŠ¡

```bash
# ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
python start.py

# æˆ–ç›´æ¥è¿è¡Œ
python main.py
```

### 3. è®¿é—®æœåŠ¡

- **APIæ–‡æ¡£**: http://127.0.0.1:8000/docs
- **æœåŠ¡ä¿¡æ¯**: http://127.0.0.1:8000/info  
- **å¥åº·æ£€æŸ¥**: http://127.0.0.1:8000/api/v1/health

## ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½

### ğŸ” æ™ºèƒ½ä»£ç æœç´¢
- åŸºäºBAAI/bge-m3çš„è¯­ä¹‰å‘é‡æœç´¢
- æ”¯æŒä¸­æ–‡ä»£ç æ³¨é‡Šå’Œæ–‡æ¡£æ£€ç´¢
- ç›¸ä¼¼åº¦åˆ†æ•°å’Œç»“æœæ’åº

### ğŸ“Š æ•°æ®ç®¡ç†
- è‡ªåŠ¨åŠ è½½parserè§£æç»“æœ
- æ”¯æŒå¢é‡å’Œå…¨é‡æ•°æ®æ›´æ–°
- å®æ—¶æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯

### ğŸ—ƒï¸ å‘é‡å­˜å‚¨
- ChromaDBæŒä¹…åŒ–å­˜å‚¨
- é«˜æ•ˆçš„å‘é‡ç›¸ä¼¼åº¦è®¡ç®—
- çµæ´»çš„å…ƒæ•°æ®è¿‡æ»¤

## ğŸ› ï¸ APIç«¯ç‚¹

### æœç´¢ç›¸å…³

**POST** `/api/v1/search` - ä»£ç æœç´¢
```json
{
  "query": "Reactç»„ä»¶çŠ¶æ€ç®¡ç†",
  "top_k": 10,
  "filter_metadata": {"file_type": "jsx"},
  "include_content": true
}
```

**GET** `/api/v1/document/{doc_id}` - è·å–ç‰¹å®šæ–‡æ¡£

### æ•°æ®ç®¡ç†

**POST** `/api/v1/load-data` - åŠ è½½è§£æå™¨æ•°æ®
```json
{
  "reload": false,
  "batch_size": 10
}
```

**GET** `/api/v1/stats` - æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯

**DELETE** `/api/v1/reset` - é‡ç½®æ•°æ®åº“

### æœåŠ¡ç®¡ç†

**POST** `/api/v1/initialize` - åˆå§‹åŒ–æœåŠ¡

**GET** `/api/v1/health` - å¥åº·æ£€æŸ¥

## ğŸ“ ç›®å½•ç»“æ„

```
rag/
â”œâ”€â”€ api/                    # APIå±‚
â”‚   â”œâ”€â”€ models.py          # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ routes.py          # è·¯ç”±å®šä¹‰
â”œâ”€â”€ database/              # æ•°æ®åº“å±‚  
â”‚   â””â”€â”€ chroma_client.py   # ChromaDBå®¢æˆ·ç«¯
â”œâ”€â”€ data_loader/           # æ•°æ®åŠ è½½å±‚
â”‚   â””â”€â”€ parser_loader.py   # è§£æå™¨æ•°æ®åŠ è½½å™¨
â”œâ”€â”€ models/                # æ¨¡å‹å±‚
â”‚   â””â”€â”€ embedding_model.py # åµŒå…¥æ¨¡å‹å°è£…
â”œâ”€â”€ config.py              # é…ç½®ç®¡ç†
â”œâ”€â”€ main.py                # ä¸»ç¨‹åº
â”œâ”€â”€ start.py               # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements.txt       # ä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md              # è¯´æ˜æ–‡æ¡£
```

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` åˆ° `.env` å¹¶æ ¹æ®éœ€è¦ä¿®æ”¹ï¼š

```bash
cp .env.example .env
```

### ä¸»è¦é…ç½®é¡¹

- **åµŒå…¥æ¨¡å‹**: BAAI/bge-m3ï¼Œæ”¯æŒä¸­æ–‡ä¼˜åŒ–
- **å‘é‡ç»´åº¦**: 1024ç»´
- **æ•°æ®åº“**: ChromaDBæŒä¹…åŒ–å­˜å‚¨
- **æ‰¹å¤„ç†**: é»˜è®¤32ä¸ªæ–‡æ¡£/æ‰¹æ¬¡

## ğŸ”§ ä½¿ç”¨ç¤ºä¾‹

### 1. åˆå§‹åŒ–æœåŠ¡

```bash
curl -X POST "http://127.0.0.1:8000/api/v1/initialize"
```

### 2. åŠ è½½æ•°æ®

```bash
# åŠ è½½è§£æå™¨è¾“å‡ºæ•°æ®
curl -X POST "http://127.0.0.1:8000/api/v1/load-data" \
  -H "Content-Type: application/json" \
  -d '{"reload": false, "batch_size": 10}'
```

### 3. æœç´¢ä»£ç 

```bash
# æœç´¢Reactç»„ä»¶
curl -X POST "http://127.0.0.1:8000/api/v1/search" \
  -H "Content-Type: application/json" \
  -d '{
    "query": "useState Hookçš„ä½¿ç”¨",
    "top_k": 5,
    "include_content": true
  }'
```

### 4. æŸ¥çœ‹ç»Ÿè®¡

```bash
curl "http://127.0.0.1:8000/api/v1/stats"
```

## ğŸ” æ•°æ®å¤„ç†æµç¨‹

### 1. æ•°æ®å‘ç°
- æ‰«æ `parser/output/` ç›®å½•
- è¯†åˆ«æ‰€æœ‰JSONæ–‡ä»¶ï¼ˆé™¤project-summary.jsonï¼‰

### 2. å†…å®¹æå–
- **æ–‡ä»¶çº§åˆ«**: æå–æ–‡ä»¶æ‘˜è¦ã€ä¾èµ–å…³ç³»
- **å®šä¹‰çº§åˆ«**: æå–ç»„ä»¶ã€å‡½æ•°ã€ç±»çš„è¯¦ç»†ä¿¡æ¯

### 3. å‘é‡åŒ–
- ä½¿ç”¨BAAI/bge-m3æ¨¡å‹ç”ŸæˆåµŒå…¥å‘é‡
- ä¼˜åŒ–ä¸­æ–‡ä»£ç æ³¨é‡Šå¤„ç†

### 4. å­˜å‚¨
- ChromaDBå‘é‡å­˜å‚¨
- ä¿ç•™å®Œæ•´å…ƒæ•°æ®ä¿¡æ¯

## ğŸš¨ æ•…éšœæ’é™¤

### ç¯å¢ƒé—®é¢˜
```bash
# æ£€æŸ¥condaç¯å¢ƒ
conda info --envs

# æ¿€æ´»ç¯å¢ƒ
conda activate codewise

# æ£€æŸ¥PythonåŒ…
pip list | grep -E "(fastapi|chromadb|torch)"
```

### æ¨¡å‹åŠ è½½é—®é¢˜
```bash
# æ£€æŸ¥æ¨¡å‹æ–‡ä»¶
ls -la ../models/

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
tail -f rag_service.log
```

### æ•°æ®åº“é—®é¢˜
```bash
# æ£€æŸ¥æ•°æ®åº“ç›®å½•
ls -la ../db/

# é‡ç½®æ•°æ®åº“
curl -X DELETE "http://127.0.0.1:8000/api/v1/reset"
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### æ‰¹å¤„ç†ä¼˜åŒ–
- è°ƒæ•´ `batch_size` å‚æ•°
- ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ

### å‘é‡æœç´¢ä¼˜åŒ–
- è®¾ç½®åˆé€‚çš„ `top_k` å€¼
- ä½¿ç”¨å…ƒæ•°æ®è¿‡æ»¤å‡å°‘æœç´¢èŒƒå›´

### æ¨¡å‹ä¼˜åŒ–
- æ ¹æ®ç¡¬ä»¶é€‰æ‹©è®¾å¤‡ï¼ˆCPU/GPU/MPSï¼‰
- è°ƒæ•´ `max_seq_length` å‚æ•°

## ğŸ”— ç›¸å…³æœåŠ¡

- **Parser**: ä»£ç è§£æå’ŒçŸ¥è¯†å›¾è°±æ„å»º
- **Agent**: LangGraphæ™ºèƒ½ä»£ç†æœåŠ¡
- **Frontend**: Reactå‰ç«¯ç•Œé¢

## ğŸ“ å¼€å‘æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒç®¡ç†**: å§‹ç»ˆåœ¨ `codewise` è™šæ‹Ÿç¯å¢ƒä¸­å¼€å‘
2. **ä¸­æ–‡æ”¯æŒ**: æ‰€æœ‰æ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯ä½¿ç”¨ä¸­æ–‡
3. **å¼‚æ­¥å¤„ç†**: æ•°æ®åŠ è½½ä½¿ç”¨å¼‚æ­¥æ“ä½œæå‡æ€§èƒ½
4. **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•
5. **èµ„æºç®¡ç†**: åŠæ—¶æ¸…ç†æ¨¡å‹å’Œæ•°æ®åº“è¿æ¥